

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mesa Overview &mdash; SOBA 1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="SOBA 1 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SOBA
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="howinstall.html">How install</a></li>
<li class="toctree-l1"><a class="reference internal" href="basictutorial.html">Introductory Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="advancedtutorial.html">Advanced Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SOBA</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Mesa Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/overview.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mesa-overview">
<h1>Mesa Overview<a class="headerlink" href="#mesa-overview" title="Permalink to this headline">¶</a></h1>
<p>Mesa is a modular framework for building, analyzing and visualizing agent-based models.</p>
<p><strong>Agent-based models</strong> are computer simulations involving multiple entities (the agents) acting and interacting with one another based on their programmed behavior. Agents can be used to represent living cells, animals, individual humans, even entire organizations or abstract entities. Sometimes, we may have an understanding of how the individual components of a system behave, and want to see what system-level behaviors and effects emerge from their interaction. Other times, we may have a good idea of how the system overall behaves, and want to figure out what individual behaviors explain it. Or we may want to see how to get agents to cooperate or compete most effectively. Or we may just want to build a cool toy with colorful little dots moving around.</p>
<div class="section" id="mesa-modules">
<h2>Mesa Modules<a class="headerlink" href="#mesa-modules" title="Permalink to this headline">¶</a></h2>
<p>Mesa is modular, meaning that its modeling, analysis and visualization components are kept separate but intended to work together. The modules are grouped into three categories:</p>
<ol class="arabic simple">
<li><strong>Modeling:</strong> Modules used to build the models themselves: a model and agent classes, a scheduler to determine the sequence in which the agents act, and space for them to move around on.</li>
<li><strong>Analysis:</strong> Tools to collect data generated from your model, or to run it multiple times with different parameter values.</li>
<li><strong>Visualization:</strong> Classes to create and launch an interactive model visualization, using a server with a JavaScript interface.</li>
</ol>
<div class="section" id="modeling-modules">
<h3>Modeling modules<a class="headerlink" href="#modeling-modules" title="Permalink to this headline">¶</a></h3>
<p>Most models consist of one class to represent the model itself; one class (or more) for agents; a scheduler to handle time (what order the agents act in), and possibly a space for the agents to inhabit and move through. These are implemented in Mesa&#8217;s modeling modules:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">mesa.Model</span></code>, <code class="docutils literal"><span class="pre">mesa.Agent</span></code></li>
<li><a class="reference external" href="apis/time.html">mesa.time</a></li>
<li><a class="reference external" href="apis/space.html">mesa.space</a></li>
</ul>
<p>The skeleton of a model might look like this:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">mesa</span> <span class="k">import</span> <span class="n">Agent</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">mesa.time</span> <span class="k">import</span> <span class="n">RandomActivation</span>
<span class="kn">from</span> <span class="nn">mesa.space</span> <span class="k">import</span> <span class="n">MultiGrid</span>

<span class="k">class</span> <span class="nc">MyAgent</span><span class="p">(</span><span class="n">Agent</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> activated&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c1"># Whatever else the agent does when activated</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_agents</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="n">RandomActivation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">MultiGrid</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">torus</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agents</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">MyAgent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">place_agent</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
<p>If you instantiate a model and run it for one step, like so:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
<p>You should see agents 0-4, activated in random order. See the <a class="reference external" href="tutorials/intro_tutorial.html">tutorial</a> or API documentation for more detail on how to add model functionality.</p>
</div>
<div class="section" id="analysis-modules">
<h3>Analysis modules<a class="headerlink" href="#analysis-modules" title="Permalink to this headline">¶</a></h3>
<p>If you&#8217;re using modeling for research, you&#8217;ll want a way to collect the data each model run generates. You&#8217;ll probably also want to run the model multiple times, to see how some output changes with different parameters. Data collection and batch running are implemented in the appropriately-named analysis modules:</p>
<ul class="simple">
<li><a class="reference external" href="apis/datacollection.html">mesa.datacollection</a></li>
<li><a class="reference external" href="apis/batchrunner.html">mesa.batchrunner</a></li>
</ul>
<p>You&#8217;d add a data collector to the model like this:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mesa.datacollection</span> <span class="k">import</span> <span class="n">DataCollector</span>

<span class="c1"># ...</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_agents</span><span class="p">):</span>
        <span class="c1"># ...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dc</span> <span class="o">=</span> <span class="n">DataCollector</span><span class="p">(</span><span class="n">model_reporters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;agent_count&quot;</span><span class="p">:</span>
                                    <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">get_agent_count</span><span class="p">()},</span>
                                <span class="n">agent_reporters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dc</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>
</div>
<p>The data collector will collect the specified model- and agent-level data at each step of the model. After you&#8217;re done running it, you can extract the data as a <a class="reference external" href="http://pandas.pydata.org/">pandas</a> DataFrame:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<span class="n">model_df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">dc</span><span class="o">.</span><span class="n">get_model_vars_dataframe</span><span class="p">()</span>
<span class="n">agent_df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">dc</span><span class="o">.</span><span class="n">get_agent_vars_dataframe</span><span class="p">()</span>
</pre></div>
</div>
<p>To batch-run the model while varying, for example, the n_agents parameter, you&#8217;d use the batchrunner:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mesa.batchrunner</span> <span class="k">import</span> <span class="n">BatchRunner</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_agents&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)}</span>
<span class="n">batch_run</span> <span class="o">=</span> <span class="n">BatchRunner</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">model_reporters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_agents&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">get_agent_count</span><span class="p">()})</span>
<span class="n">batch_run</span><span class="o">.</span><span class="n">run_all</span><span class="p">()</span>
</pre></div>
</div>
<p>As with the data collector, once the runs are all over, you can extract the data as a data frame.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">batch_df</span> <span class="o">=</span> <span class="n">batch_run</span><span class="o">.</span><span class="n">get_model_vars_dataframe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="visualization-modules">
<h3>Visualization modules<a class="headerlink" href="#visualization-modules" title="Permalink to this headline">¶</a></h3>
<p>Finally, you may want to directly observe your model as it runs. Mesa&#8217;s main visualization tool uses a small local web server to render the model in a browser, using JavaScript. There are different components for drawing different types of data: for example, grids for drawing agents moving around on a grid, or charts for showing how some data changes as the model runs. A few core modules are:</p>
<ul class="simple">
<li>mesa.visualization.ModularVisualization</li>
<li>mesa.visualization.modules</li>
</ul>
<p>To quickly spin up a model visualization, you might do something like:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mesa.visualization.modules</span> <span class="k">import</span> <span class="n">CanvasGrid</span>
<span class="kn">from</span> <span class="nn">mesa.visualization.ModularVisualization</span> <span class="k">import</span> <span class="n">ModularServer</span>

<span class="k">def</span> <span class="nf">agent_portrayal</span><span class="p">(</span><span class="n">agent</span><span class="p">):</span>
    <span class="n">portrayal</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Shape&quot;</span><span class="p">:</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Filled&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Layer&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                 <span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">portrayal</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">CanvasGrid</span><span class="p">(</span><span class="n">agent_portrayal</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">ModularServer</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span>
                       <span class="p">[</span><span class="n">grid</span><span class="p">],</span>
                       <span class="s2">&quot;My Model&quot;</span><span class="p">,</span>
                       <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">launch</span><span class="p">()</span>
</pre></div>
</div>
<p>This will launch the browser-based visualization, on the default port 8521.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Eduardo Merino.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>